<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>End of the journey</title>
  <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/nitnapple/Assignments/refs/heads/main/bw_crown_1.ico">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes blink {
      50% { border-color: transparent; }
    }
    .typewriter {
      display: inline-block;
      border-right: 2px solid white;
      animation: blink 1s step-end infinite;
      white-space: pre-wrap;
      word-break: break-word;
    }
    @media (max-width: 640px) {
      h2 { font-size: 1rem; }
    }
    body { transition: filter 2s linear; }
    .glow {
      position: absolute;
      pointer-events: none;
      border-radius: 50%;
      z-index: 51;
      background: radial-gradient(circle, rgba(255, 244, 229, 0.5) 0%, transparent 70%);
      animation: glow-animation 0.6s ease-out forwards;
    }
    .glow.strong {
      background: radial-gradient(circle, rgba(255,244,229,0.8) 0%, transparent 80%);
      animation: glow-animation-strong 1.2s ease-out forwards;
    }
    @keyframes glow-animation {
      0% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(2.5);
      }
    }
    @keyframes glow-animation-strong {
      0% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(-50%, -50%) scale(3.5);
      }
    }
    /* Grayscale overlay */
    #grayscale-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 50;
      filter: grayscale(80%) contrast(300%) brightness(70%);
      transition: clip-path 0.3s, opacity 0.3s;
      /* Default: no hole */
      clip-path: none;
      opacity: 1;
    }
    #grayscale-overlay.hide {
      opacity: 0;
      transition: opacity 1s;
    }
  </style>
</head>
<body class="m-0 p-0">
  <div class="relative w-screen h-screen overflow-hidden" id="click-target">
    <!-- Background Video -->
    <video autoplay muted loop playsinline class="absolute top-0 left-0 w-full h-full object-cover z-0">
      <source src="https://raw.githubusercontent.com/nitnapple/src/refs/heads/main/us.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>

    <!-- Overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-40 z-10"></div>

    <!-- Content -->
    <div class="absolute inset-0 flex flex-col items-center justify-start z-20 px-4 pt-10 text-center space-y-6">
      <div class="max-w-sm sm:max-w-xl">
        <h2 class="text-white text-lg sm:text-xl md:text-2xl font-semibold drop-shadow-lg leading-relaxed">
          <span id="typewriter" class="typewriter"></span>
        </h2>
      </div>
      <a href="https://nitnapple.github.io/Ananya/Archive" rel="noopener noreferrer" id="archive-link" class="hidden">
        <button class="bg-white bg-opacity-80 hover:bg-opacity-100 text-black font-semibold py-2 px-6 rounded-full shadow-md transition duration-300">
          Archive
        </button>
      </a>
    </div>
    <!-- Footer -->
    <div class="absolute bottom-5 left-0 right-0 z-30 flex justify-center">
      <div class="text-center">
        <a href="https://instagram.com/nitin_apple" target="_blank" rel="noopener noreferrer" class="inline-block">
          <svg class="w-7 h-7 text-white hover:text-pink-400 transition duration-300" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2.2c3.2 0 3.6 0 4.8.1 1.2.1 1.9.3 2.4.6.5.3.9.7 1.3 1.3.3.5.5 1.2.6 2.4.1 1.2.1 1.6.1 4.8s0 3.6-.1 4.8c-.1 1.2-.3 1.9-.6 2.4-.3.5-.7.9-1.3 1.3-.5.3-1.2.5-2.4.6-1.2.1-1.6.1-4.8.1s-3.6 0-4.8-.1c-1.2-.1-1.9-.3-2.4-.6-.5-.3-.9-.7-1.3-1.3-.3-.5-.5-1.2-.6-2.4C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.8c.1-1.2.3-1.9.6-2.4.3-.5.7-.9 1.3-1.3.5-.3 1.2-.5 2.4-.6C8.4 2.2 8.8 2.2 12 2.2zm0-2.2C8.7 0 8.3 0 7.1.1 5.8.2 4.8.4 4 .9 3.1 1.3 2.3 2.1 1.9 3 .4 3.8.2 4.8.1 6.1 0 7.3 0 7.7 0 12s0 4.7.1 5.9c.1 1.3.3 2.3.8 3.1.4.9 1.2 1.7 2.1 2.1.8.4 1.8.7 3.1.8 1.2.1 1.6.1 5.9.1s4.7 0 5.9-.1c1.3-.1 2.3-.3 3.1-.8.9-.4 1.7-1.2 2.1-2.1.4-.8.7-1.8.8-3.1.1-1.2.1-1.6.1-5.9s0-4.7-.1-5.9c-.1-1.3-.3-2.3-.8-3.1-.4-.9-1.2-1.7-2.1-2.1-.8-.4-1.8-.7-3.1-.8C15.7 0 15.3 0 12 0zM12 5.8c-3.4 0-6.2 2.8-6.2 6.2S8.6 18.2 12 18.2 18.2 15.4 18.2 12 15.4 5.8 12 5.8zm0 10.2c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4zm5.8-10.7c-.8 0-1.5.6-1.5 1.5s.6 1.5 1.5 1.5 1.5-.6 1.5-1.5-.7-1.5-1.5-1.5z"/>
          </svg>
        </a>
        <p class="text-white text-sm mt-2">© 2025</p>
      </div>
    </div>
  </div>
  <!-- Grayscale overlay (initially hidden) -->
  <div id="grayscale-overlay" style="display:none;"></div>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Typewriter effect
      const text = "Thank you for being a part of this beautiful journey—may we meet again someday, with even warmer smiles and happier hearts.";
      const el = document.getElementById("typewriter");
      const archiveLink = document.getElementById("archive-link");
      let index = 0;
      function type() {
        if (index < text.length) {
          el.textContent += text.charAt(index++);
          setTimeout(type, 40);
        } else {
          el.style.borderRight = "none";
          archiveLink.classList.remove("hidden");
        }
      }
      type();

      // Prepare sound effect
      const clickSound = new Audio("https://raw.githubusercontent.com/nitnapple/src/refs/heads/main/lumos_sound_effect.mp3");
      let soundUnlocked = false;

      // Unlock sound on first user gesture (for iOS)
      function unlockSound() {
        if (!soundUnlocked) {
          clickSound.play().catch(()=>{});
          clickSound.pause();
          clickSound.currentTime = 0;
          soundUnlocked = true;
        }
      }
      window.addEventListener('touchstart', unlockSound, { once: true });
      window.addEventListener('mousedown', unlockSound, { once: true });

      // Grayscale overlay logic
      const overlay = document.getElementById('grayscale-overlay');
      let grayscaleActive = false;
      let overlayTimeout = null;

      function showGrayscaleOverlay() {
        overlay.style.display = '';
        overlay.style.pointerEvents = 'none';
        overlay.classList.remove('hide');
        overlay.style.clipPath = 'none';
        // Copy the page's HTML into the overlay for perfect alignment
        // (not needed since overlay is transparent, just covers the page)
      }
      function hideGrayscaleOverlay() {
        overlay.classList.add('hide');
        setTimeout(() => { overlay.style.display = 'none'; }, 1000);
      }

      // Glow + color reveal helper
      function showGlow(x, y, options = {}) {
        // Glow visual
        const glow = document.createElement('div');
        glow.className = 'glow' + (options.strong ? ' strong' : '');
        glow.style.left = `${x}px`;
        glow.style.top = `${y}px`;
        glow.style.width = options.strong ? "260px" : "100px";
        glow.style.height = options.strong ? "260px" : "100px";
        document.body.appendChild(glow);

        // Color reveal: animate a circular hole in the grayscale overlay
        if (grayscaleActive) {
          const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
          const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);

          // Calculate percent for clip-path
          const cx = (x / vw) * 100;
          const cy = (y / vh) * 100;
          const startRadius = options.strong ? 130 : 50; // px, matches glow
          const endRadius = options.strong ? 455 : 250; // px, matches animation scale

          // Animate the hole
          let start = null;
          function animateHole(ts) {
            if (!start) start = ts;
            let progress = Math.min((ts - start) / (options.strong ? 1200 : 600), 1);
            // Ease out
            progress = 1 - Math.pow(1 - progress, 2);
            const radius = startRadius + (endRadius - startRadius) * progress;
            overlay.style.clipPath = `circle(${radius}px at ${cx}% ${cy}%)`;
            if (progress < 1) {
              requestAnimationFrame(animateHole);
            } else {
              overlay.style.clipPath = 'none';
            }
          }
          overlay.style.clipPath = `circle(${startRadius}px at ${cx}% ${cy}%)`;
          requestAnimationFrame(animateHole);
        }

        setTimeout(() => {
          glow.remove();
        }, options.strong ? 1200 : 600);
      }

      // Vibrate and sound
      function vibrateAndSound(duration = 50) {
        if (window.navigator && window.navigator.vibrate) {
          window.navigator.vibrate(duration);
        }
        if (soundUnlocked) {
          clickSound.currentTime = 0;
          clickSound.play();
        }
      }

      // Tap and Tap-and-hold logic
      const target = document.getElementById("click-target");
      let pressTimer = null;
      let longPressFired = false;
      let lastTouchTime = 0;

      function triggerTap(x, y) {
        vibrateAndSound(50);
        showGlow(x, y);
      }

      function triggerLongPress(x, y) {
        vibrateAndSound(120);
        showGlow(x, y, { strong: true });
      }

      // Mouse events
      target.addEventListener("mousedown", function(e) {
        if (e.button !== 0) return;
        longPressFired = false;
        pressTimer = setTimeout(() => {
          longPressFired = true;
          triggerLongPress(e.clientX, e.clientY);
        }, 400);
      });
      target.addEventListener("mouseup", function(e) {
        clearTimeout(pressTimer);
        if (!longPressFired) triggerTap(e.clientX, e.clientY);
      });
      target.addEventListener("mouseleave", function() {
        clearTimeout(pressTimer);
      });

      // Touch events (allow scrolling)
      target.addEventListener("touchstart", function(e) {
        if (!e.touches || e.touches.length === 0) return;
        const touch = e.touches[0];
        longPressFired = false;
        pressTimer = setTimeout(() => {
          longPressFired = true;
          if (e.cancelable) e.preventDefault();
          triggerLongPress(touch.pageX, touch.pageY);
        }, 400);
      }, { passive: true });

      target.addEventListener("touchend", function(e) {
        clearTimeout(pressTimer);
        if (!longPressFired) {
          if (!e.changedTouches || e.changedTouches.length === 0) return;
          const touch = e.changedTouches[0];
          triggerTap(touch.pageX, touch.pageY);
        }
        lastTouchTime = Date.now();
      }, { passive: true });

      target.addEventListener("touchmove", function() {
        clearTimeout(pressTimer);
      }, { passive: true });

      // Prevent click after touch (iOS sends both)
      target.addEventListener("click", function(e) {
        if (Date.now() - lastTouchTime < 500) {
          e.preventDefault();
          e.stopPropagation();
          return false;
        }
      }, true);

      // Grayscale overlay after delay
      setTimeout(() => {
        grayscaleActive = true;
        showGrayscaleOverlay();
      }, 3000);

      // Ensure overlay always covers viewport
      function resizeOverlay() {
        overlay.style.width = window.innerWidth + "px";
        overlay.style.height = window.innerHeight + "px";
      }
      window.addEventListener('resize', resizeOverlay);
      resizeOverlay();
    });
  </script>
</body>
</html>
